"use strict";(self.webpackChunkreact_chat_app=self.webpackChunkreact_chat_app||[]).push([[573,815],{18573:function(e,a,t){t.r(a);var s=t(4942),n=t(42982),r=t(74165),c=t(1413),l=t(15861),i=t(70885),u=t(72791),d=t(59930),h=t(2703),m=t(14717),o=t(19855),f=t(72426),v=t.n(f),x=t(28815),p=t(80184);a.default=function(){var e=(0,m.useAuth)().chatId,a=(0,m.useSocket)(),t=a.socket,f=a.connected,_=(0,u.useState)({recent:[],favourite:[],group:[]}),j=(0,i.Z)(_,2),N=j[0],g=j[1],Z=(0,u.useState)(!0),C=(0,i.Z)(Z,2),b=C[0],k=C[1],I=N.favourite,w=N.recent,F=N.group;(0,u.useEffect)((function(){t&&f&&t.on("new-message",y)}),[f,t]),(0,u.useEffect)((function(){S()}),[]);var S=function(){var e=(0,l.Z)((0,r.Z)().mark((function e(){var a,t,s,n,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=Promise,e.next=4,(0,o.getRecentChats)();case 4:return e.t1=e.sent,e.next=7,(0,o.getFavouriteChats)();case 7:return e.t2=e.sent,e.next=10,(0,o.getGroupChats)();case 10:return e.t3=e.sent,e.t4=[e.t1,e.t2,e.t3],e.next=14,e.t0.all.call(e.t0,e.t4);case 14:a=e.sent,t=(0,i.Z)(a,3),s=t[0],n=t[1],l=t[2],g((0,c.Z)((0,c.Z)({},N),{},{recent:s.data.data,favourite:n.data.data,group:l.data.data})),e.next=25;break;case 22:e.prev=22,e.t5=e.catch(0),(0,d.Toast)({type:"error",message:null===e.t5||void 0===e.t5?void 0:e.t5.message});case 25:return e.prev=25,k(!1),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[0,22,25,28]])})));return function(){return e.apply(this,arguments)}}(),y=function(a){var t=N[a.type].findIndex((function(a){return a._id===e}));-1!==t&&g((function(e){var r=a.type,l=(0,n.Z)(e[r]),u=l.splice(t,1),d=(0,i.Z)(u,1)[0];return d.count+=1,(0,c.Z)((0,c.Z)({},e),{},(0,s.Z)({},r,[(0,c.Z)((0,c.Z)({},d),a)].concat((0,n.Z)(l))))}))},A=function(e){return e.split("T")[0]===(new Date).toISOString().split("T")[0]?v()(e).format("h:mm a"):v()(e).format("DD/MM/YY")};return b?(0,p.jsx)("div",{children:"Loading..."}):(0,p.jsxs)("div",{className:x.default.chat_list_container,children:[I.length>0&&(0,p.jsxs)(u.Fragment,{children:[(0,p.jsx)("div",{className:x.default.title,children:(0,p.jsx)("b",{children:"Favourites"})}),I.map((function(a,t){var n=a._id,r=a.count,c=a.msg,l=a.date,i=a.name,u=a.avatar,m=a.status,o=a.userId;return(0,p.jsxs)("div",{className:(0,h.classNames)(x.default.user_card,(0,s.Z)({},x.default.active,n===e)),onClick:function(){return(0,h.handleChat)(n)},children:[(0,p.jsxs)("div",{className:x.default.user,children:[(0,p.jsx)(d.Avatar,{src:u,name:i,status:m,size:35,userId:o}),(0,p.jsxs)("div",{className:x.default.msg,children:[(0,p.jsx)("span",{className:"truncate-1",children:i}),(0,p.jsx)("span",{className:"truncate-1",children:c})]})]}),(0,p.jsxs)("div",{className:(0,h.classNames)(x.default.time,(0,s.Z)({},x.default.top,!r)),children:[(0,p.jsx)("span",{children:A(l)}),r>0&&(0,p.jsx)("label",{children:r})]})]},t)}))]}),w.length>0&&(0,p.jsxs)(u.Fragment,{children:[(0,p.jsx)("div",{className:x.default.title,children:(0,p.jsx)("b",{children:"Recent Chats"})}),w.map((function(a,t){var n=a._id,r=a.count,c=a.msg,l=a.date,i=a.name,u=a.avatar,m=a.status,o=a.userId;return(0,p.jsxs)("div",{className:(0,h.classNames)(x.default.user_card,(0,s.Z)({},x.default.active,n===e)),onClick:function(){return(0,h.handleChat)(n)},children:[(0,p.jsxs)("div",{className:x.default.user,children:[(0,p.jsx)(d.Avatar,{src:u,name:i,status:m,size:35,userId:o}),(0,p.jsxs)("div",{className:x.default.msg,children:[(0,p.jsx)("span",{className:"truncate-1",children:i}),(0,p.jsx)("span",{className:"truncate-1",children:c})]})]}),(0,p.jsxs)("div",{className:(0,h.classNames)(x.default.time,(0,s.Z)({},x.default.top,!r)),children:[(0,p.jsx)("span",{children:A(l)}),r>0&&(0,p.jsx)("label",{children:r})]})]},t)}))]}),F.length>0&&(0,p.jsxs)(u.Fragment,{children:[(0,p.jsxs)("div",{className:x.default.title,children:[(0,p.jsx)("b",{children:"Groups"}),(0,p.jsx)("button",{children:(0,p.jsx)("i",{className:"bx-plus"})})]}),F.map((function(a,t){var n=a._id,r=a.count,c=a.msg,l=a.date,i=a.name,u=a.avatar;return(0,p.jsxs)("div",{className:(0,h.classNames)(x.default.user_card,(0,s.Z)({},x.default.active,n===e)),onClick:function(){return(0,h.handleChat)(n)},children:[(0,p.jsxs)("div",{className:x.default.user,children:[(0,p.jsx)(d.Avatar,{src:u,name:i,size:35}),(0,p.jsxs)("div",{className:x.default.msg,children:[(0,p.jsx)("span",{className:"truncate-1",children:i}),(0,p.jsx)("span",{className:"truncate-1",children:c})]})]}),(0,p.jsxs)("div",{className:(0,h.classNames)(x.default.time,(0,s.Z)({},x.default.top,!r)),children:[(0,p.jsx)("span",{children:A(l)}),r>0&&(0,p.jsx)("label",{children:r})]})]},t)}))]})]})}},28815:function(e,a,t){t.r(a),a.default={chat_list_container:"Chats_chat_list_container__Lo8ht",title:"Chats_title__ncpOR",user_card:"Chats_user_card__m+jOS",active:"Chats_active__07HzW",user:"Chats_user__LeGpu",msg:"Chats_msg__y5EF6",time:"Chats_time__hAPQQ",top:"Chats_top__dpX3P"}}}]);
//# sourceMappingURL=573.3a0eab3c.chunk.js.map