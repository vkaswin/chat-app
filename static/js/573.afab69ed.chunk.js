"use strict";(self.webpackChunkreact_chat_app=self.webpackChunkreact_chat_app||[]).push([[573,815],{18573:function(e,a,t){t.r(a);var s=t(4942),n=t(42982),r=t(74165),c=t(1413),i=t(15861),l=t(70885),u=t(72791),d=t(59930),h=t(2703),o=t(14717),m=t(19855),f=t(89102),v=t(72426),x=t.n(v),p=t(28815),_=t(80184);a.default=function(){var e=(0,o.useAuth)(),a=e.user,t=e.chatId,v=(0,u.useState)({recent:[],favourite:[],group:[]}),j=(0,l.Z)(v,2),N=j[0],g=j[1],Z=(0,u.useState)(!0),C=(0,l.Z)(Z,2),k=C[0],b=C[1],w=N.favourite,F=N.recent,A=N.group;(0,u.useEffect)((function(){f.socket.io&&a&&(f.socket.io.emit("join-room",a.id),f.socket.io.on("new-message",y))}),[]),(0,u.useEffect)((function(){S()}),[]);var S=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var a,t,s,n,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=Promise,e.next=4,(0,m.getRecentChats)();case 4:return e.t1=e.sent,e.next=7,(0,m.getFavouriteChats)();case 7:return e.t2=e.sent,e.next=10,(0,m.getGroupChats)();case 10:return e.t3=e.sent,e.t4=[e.t1,e.t2,e.t3],e.next=14,e.t0.all.call(e.t0,e.t4);case 14:a=e.sent,t=(0,l.Z)(a,3),s=t[0],n=t[1],i=t[2],g((0,c.Z)((0,c.Z)({},N),{},{recent:s.data.data,favourite:n.data.data,group:i.data.data})),e.next=25;break;case 22:e.prev=22,e.t5=e.catch(0),(0,d.Toast)({type:"error",message:null===e.t5||void 0===e.t5?void 0:e.t5.message});case 25:return e.prev=25,b(!1),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[0,22,25,28]])})));return function(){return e.apply(this,arguments)}}(),y=function(e){console.log(e),g((function(a){var t=e.type,r=(0,n.Z)(a[t]),i=r.findIndex((function(a){return a._id===e.chatId})),u=r.splice(i,1),d=(0,l.Z)(u,1)[0];return d.count+=1,(0,c.Z)((0,c.Z)({},a),{},(0,s.Z)({},t,[(0,c.Z)((0,c.Z)({},d),e)].concat((0,n.Z)(r))))}))},z=function(e){return e.split("T")[0]===(new Date).toISOString().split("T")[0]?x()(e).format("h:mm a"):x()(e).format("DD/MM/YY")};return k?(0,_.jsx)("div",{children:"Loading..."}):(0,_.jsxs)("div",{className:p.default.chat_list_container,children:[w.length>0&&(0,_.jsxs)(u.Fragment,{children:[(0,_.jsx)("div",{className:p.default.title,children:(0,_.jsx)("b",{children:"Favourites"})}),w.map((function(e,a){var n=e._id,r=e.count,c=e.msg,i=e.date,l=e.name,u=e.avatar,o=e.status;return(0,_.jsxs)("div",{className:(0,h.classNames)(p.default.user_card,(0,s.Z)({},p.default.active,n===t)),onClick:function(){return(0,h.handleChat)(n)},children:[(0,_.jsxs)("div",{className:p.default.user,children:[(0,_.jsx)(d.Avatar,{src:u,name:l,status:o,size:35}),(0,_.jsxs)("div",{className:p.default.msg,children:[(0,_.jsx)("span",{className:"truncate-1",children:l}),(0,_.jsx)("span",{className:"truncate-2",children:c})]})]}),(0,_.jsxs)("div",{className:(0,h.classNames)(p.default.time,(0,s.Z)({},p.default.top,!r)),children:[(0,_.jsx)("span",{children:z(i)}),r>0&&(0,_.jsx)("label",{children:r})]})]},a)}))]}),F.length>0&&(0,_.jsxs)(u.Fragment,{children:[(0,_.jsx)("div",{className:p.default.title,children:(0,_.jsx)("b",{children:"Recent Chats"})}),F.map((function(e,a){var n=e._id,r=e.count,c=e.msg,i=e.date,l=e.name,u=e.avatar,o=e.status;return(0,_.jsxs)("div",{className:(0,h.classNames)(p.default.user_card,(0,s.Z)({},p.default.active,n===t)),onClick:function(){return(0,h.handleChat)(n)},children:[(0,_.jsxs)("div",{className:p.default.user,children:[(0,_.jsx)(d.Avatar,{src:u,name:l,status:o,size:35}),(0,_.jsxs)("div",{className:p.default.msg,children:[(0,_.jsx)("span",{className:"truncate-1",children:l}),(0,_.jsx)("span",{className:"truncate-2",children:c})]})]}),(0,_.jsxs)("div",{className:(0,h.classNames)(p.default.time,(0,s.Z)({},p.default.top,!r)),children:[(0,_.jsx)("span",{children:z(i)}),r>0&&(0,_.jsx)("label",{children:r})]})]},a)}))]}),A.length>0&&(0,_.jsxs)(u.Fragment,{children:[(0,_.jsxs)("div",{className:p.default.title,children:[(0,_.jsx)("b",{children:"Groups"}),(0,_.jsx)("button",{children:(0,_.jsx)("i",{className:"bx-plus"})})]}),A.map((function(e,a){var n=e._id,r=e.count,c=e.msg,i=e.date,l=e.name,u=e.avatar;return(0,_.jsxs)("div",{className:(0,h.classNames)(p.default.user_card,(0,s.Z)({},p.default.active,n===t)),onClick:function(){return(0,h.handleChat)(n)},children:[(0,_.jsxs)("div",{className:p.default.user,children:[(0,_.jsx)(d.Avatar,{src:u,name:l,size:35}),(0,_.jsxs)("div",{className:p.default.msg,children:[(0,_.jsx)("span",{className:"truncate-1",children:l}),(0,_.jsx)("span",{className:"truncate-2",children:c})]})]}),(0,_.jsxs)("div",{className:(0,h.classNames)(p.default.time,(0,s.Z)({},p.default.top,!r)),children:[(0,_.jsx)("span",{children:z(i)}),r>0&&(0,_.jsx)("label",{children:r})]})]},a)}))]})]})}},28815:function(e,a,t){t.r(a),a.default={chat_list_container:"Chats_chat_list_container__Lo8ht",title:"Chats_title__ncpOR",user_card:"Chats_user_card__m+jOS",active:"Chats_active__07HzW",user:"Chats_user__LeGpu",msg:"Chats_msg__y5EF6",time:"Chats_time__hAPQQ",top:"Chats_top__dpX3P"}}}]);
//# sourceMappingURL=573.afab69ed.chunk.js.map