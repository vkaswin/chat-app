"use strict";(self.webpackChunkreact_chat_app=self.webpackChunkreact_chat_app||[]).push([[573,815],{8573:function(t,e,a){a.r(e);var s=a(2982),n=a(4942),r=a(4165),c=a(1413),i=a(5861),u=a(885),l=a(2791),d=a(9930),o=a(2703),h=a(4717),m=a(9855),f=a(2426),p=a.n(f),v=a(9102),x=a(8815),_=a(184);e.default=function(){var t=(0,h.useAuth)().chatId,e=(0,l.useState)({recent:[],favourite:[],group:[]}),a=(0,u.Z)(e,2),f=a[0],j=a[1],g=(0,l.useState)(!0),N=(0,u.Z)(g,2),Z=N[0],C=N[1],y=f.favourite,k=f.recent,b=f.group;(0,l.useEffect)((function(){return document.addEventListener("socket",S),A(),function(){document.removeEventListener("socket",S)}}),[]);var S=function(){v.socket.on("new-message",I),v.socket.on("start-typing",F),v.socket.on("end-typing",L)},A=function(){var t=(0,i.Z)((0,r.Z)().mark((function t(){var e,a,s,n,i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=Promise,t.next=4,(0,m.getRecentChats)();case 4:return t.t1=t.sent,t.next=7,(0,m.getFavouriteChats)();case 7:return t.t2=t.sent,t.next=10,(0,m.getGroupChats)();case 10:return t.t3=t.sent,t.t4=[t.t1,t.t2,t.t3],t.next=14,t.t0.all.call(t.t0,t.t4);case 14:e=t.sent,a=(0,u.Z)(e,3),s=a[0],n=a[1],i=a[2],j((0,c.Z)((0,c.Z)({},f),{},{recent:s.data.data,favourite:n.data.data,group:i.data.data})),t.next=25;break;case 22:t.prev=22,t.t5=t.catch(0),(0,d.Toast)({type:"error",message:null===t.t5||void 0===t.t5?void 0:t.t5.message});case 25:return t.prev=25,C(!1),t.finish(25);case 28:case"end":return t.stop()}}),t,null,[[0,22,25,28]])})));return function(){return t.apply(this,arguments)}}(),I=function(t){j((function(e){var a=t.type,r=e[a].findIndex((function(e){return e._id===t._id}));if(-1===r)return t.count=1,(0,c.Z)((0,c.Z)({},e),{},(0,n.Z)({},a,[t]));var i=(0,s.Z)(e[a]),l=i.splice(r,1),d=(0,u.Z)(l,1)[0];return t.count=d.count+1,(0,c.Z)((0,c.Z)({},e),{},(0,n.Z)({},a,[t].concat((0,s.Z)(i))))}))},w=function(t){return t.split("T")[0]===(new Date).toISOString().split("T")[0]?p()(t).format("h:mm a"):p()(t).format("DD/MM/YY")},F=function(t,e){var a=document.querySelector("[chatid='".concat(t,"']"));a&&a.querySelector("[typingstatus]").setAttribute("typing","".concat(e.split(" ")[0]," is typing..."))},L=function(t){var e=document.querySelector("[chatid='".concat(t,"']"));e&&e.querySelector("[typingstatus]").removeAttribute("typing")};return Z?(0,_.jsx)("div",{children:"Loading..."}):(0,_.jsxs)("div",{className:x.default.chat_list_container,children:[y.length>0&&(0,_.jsxs)(l.Fragment,{children:[(0,_.jsx)("div",{className:x.default.title,children:(0,_.jsx)("b",{children:"Favourites"})}),y.map((function(e,a){var s=e._id,r=e.count,c=e.msg,i=e.date,u=e.name,l=e.avatar,h=e.status,m=e.userId;return(0,_.jsxs)("div",{className:(0,o.classNames)(x.default.user_card,(0,n.Z)({},x.default.active,s===t)),onClick:function(){return(0,o.handleChat)(s)},chatid:s,children:[(0,_.jsxs)("div",{className:x.default.user,children:[(0,_.jsx)(d.Avatar,{src:l,name:u,status:h,size:35,userId:m}),(0,_.jsxs)("div",{className:x.default.msg,typingstatus:"",children:[(0,_.jsx)("span",{className:"truncate-1",children:u}),(0,_.jsx)("span",{className:"truncate-1",children:c})]})]}),(0,_.jsxs)("div",{className:(0,o.classNames)(x.default.time,(0,n.Z)({},x.default.top,!r)),children:[(0,_.jsx)("span",{children:w(i)}),r>0&&(0,_.jsx)("label",{children:r})]})]},a)}))]}),k.length>0&&(0,_.jsxs)(l.Fragment,{children:[(0,_.jsx)("div",{className:x.default.title,children:(0,_.jsx)("b",{children:"Recent Chats"})}),k.map((function(e,a){var s=e._id,r=e.count,c=e.msg,i=e.date,u=e.name,l=e.avatar,h=e.status,m=e.userId;return(0,_.jsxs)("div",{className:(0,o.classNames)(x.default.user_card,(0,n.Z)({},x.default.active,s===t)),onClick:function(){return(0,o.handleChat)(s)},chatid:s,children:[(0,_.jsxs)("div",{className:x.default.user,children:[(0,_.jsx)(d.Avatar,{src:l,name:u,status:h,size:35,userId:m}),(0,_.jsxs)("div",{className:x.default.msg,typingstatus:"",children:[(0,_.jsx)("span",{className:"truncate-1",children:u}),(0,_.jsx)("span",{className:"truncate-1",children:c})]})]}),(0,_.jsxs)("div",{className:(0,o.classNames)(x.default.time,(0,n.Z)({},x.default.top,!r)),children:[(0,_.jsx)("span",{children:w(i)}),r>0&&(0,_.jsx)("label",{children:r})]})]},a)}))]}),b.length>0&&(0,_.jsxs)(l.Fragment,{children:[(0,_.jsxs)("div",{className:x.default.title,children:[(0,_.jsx)("b",{children:"Groups"}),(0,_.jsx)("button",{children:(0,_.jsx)("i",{className:"bx-plus"})})]}),b.map((function(e,a){var s=e._id,r=e.count,c=e.msg,i=e.date,u=e.name,l=e.avatar;return(0,_.jsxs)("div",{className:(0,o.classNames)(x.default.user_card,(0,n.Z)({},x.default.active,s===t)),onClick:function(){return(0,o.handleChat)(s)},chatid:s,children:[(0,_.jsxs)("div",{className:x.default.user,children:[(0,_.jsx)(d.Avatar,{src:l,name:u,size:35}),(0,_.jsxs)("div",{className:x.default.msg,typingstatus:"",children:[(0,_.jsx)("span",{className:"truncate-1",children:u}),(0,_.jsx)("span",{className:"truncate-1",children:c})]})]}),(0,_.jsxs)("div",{className:(0,o.classNames)(x.default.time,(0,n.Z)({},x.default.top,!r)),children:[(0,_.jsx)("span",{children:w(i)}),r>0&&(0,_.jsx)("label",{children:r})]})]},a)}))]})]})}},8815:function(t,e,a){a.r(e),e.default={chat_list_container:"Chats_chat_list_container__Lo8ht",title:"Chats_title__ncpOR",user_card:"Chats_user_card__m+jOS",active:"Chats_active__07HzW",user:"Chats_user__LeGpu",msg:"Chats_msg__y5EF6",time:"Chats_time__hAPQQ",top:"Chats_top__dpX3P"}}}]);
//# sourceMappingURL=573.d9408f5f.chunk.js.map