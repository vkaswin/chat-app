"use strict";(self.webpackChunkreact_chat_app=self.webpackChunkreact_chat_app||[]).push([[7352,101,4329,9599,2449,9855,3537,3487],{2775:function(e,t,n){n.r(t),n.d(t,{Conversation:function(){return f}});var r=n(4942),a=n(885),o=n(2791),i=n(9930),s=n(2703),c=n(2426),u=n.n(c),l=n(8527),d=n(184),f=function(e){var t=e.chats,n=e.onDelete,c=e.onCopy,f=e.onReply,p=e.userId,m=e.newMsg,h=e.focusMsgById,v=e.otherUserId;return(0,d.jsxs)(o.Fragment,{children:[Object.entries(t).map((function(e,t){var _=(0,a.Z)(e,2),x=_[0],j=_[1];return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)("div",{className:l.default.date,children:(0,d.jsx)("span",{children:u()(x).format("D MMMM YYYY")})}),(0,d.jsx)("div",{className:l.default.container,children:j.map((function(e,a){var _=e.msg,x=e.date,j=e.sender,g=e._id,y=e.seen,b=e.reply,w=void 0===b?null:b;return(0,d.jsxs)(o.Fragment,{children:[m.id&&m.id===g&&(0,d.jsx)("div",{className:l.default.unread_msg,children:(0,d.jsxs)("span",{children:[m.count," Unread Message",m.count>1&&"s"]})}),(0,d.jsxs)("div",{className:(0,s.classNames)(l.default.chat_wrapper,(0,r.Z)({},l.default.end,p===j)),msgid:g,children:[(0,d.jsxs)("div",{className:l.default.chat_card,children:[w&&(0,d.jsx)("div",{className:l.default.reply_card,onClick:function(){return h(w._id,"smooth")},children:(0,d.jsx)("span",{children:w.msg})}),(0,d.jsx)("div",{children:(0,d.jsx)("span",{children:_})}),(0,d.jsxs)("div",{className:l.default.msg_time,children:[(0,d.jsx)("i",{className:"bx-time ".concat(l.default.clock)}),(0,d.jsx)("span",{children:u()(new Date(x)).format("h:mm a")}),(0,d.jsx)("i",{className:"bx bx-check-double ".concat(l.default.tick),seen:Array.isArray(v)?(y.length===v.length).toString():y.includes(v).toString()})]})]}),(0,d.jsxs)("div",{className:l.default.options,children:[(0,d.jsx)("i",{className:"bx-dots-vertical-rounded",id:"option-".concat(t).concat(a)}),(0,d.jsxs)(i.DropDown,{selector:"#option-".concat(t).concat(a),placement:"bottom",children:[(0,d.jsxs)(i.DropDownItem,{className:"dropdown-option",onClick:function(){return f(x,g)},children:[(0,d.jsx)("span",{children:"Reply"}),(0,d.jsx)("i",{className:"bx-share"})]}),(0,d.jsxs)(i.DropDownItem,{className:"dropdown-option",children:[(0,d.jsx)("span",{children:"Forward"}),(0,d.jsx)("i",{className:"bx-share-alt"})]}),(0,d.jsxs)(i.DropDownItem,{className:"dropdown-option",onClick:function(){return c(_)},children:[(0,d.jsx)("span",{children:"Copy"}),(0,d.jsx)("i",{className:"bx-copy"})]}),(0,d.jsxs)(i.DropDownItem,{className:"dropdown-option",children:[(0,d.jsx)("span",{children:"Mark as Unread"}),(0,d.jsx)("i",{className:"bx-message-error"})]}),(0,d.jsxs)(i.DropDownItem,{className:"dropdown-option",onClick:function(){return n(x,g)},children:[(0,d.jsx)("span",{children:"Delete"}),(0,d.jsx)("i",{className:"bx-trash"})]})]})]})]})]},a)}))})]},t)})),(0,d.jsx)("div",{className:l.default.typing,typingstatus:""})]})}},1256:function(e,t,n){n.r(t),n.d(t,{Header:function(){return c}});var r=n(2791),a=n(9930),o=n(2703),i=n(9041),s=n(184),c=function(e){var t,n=e.clearChatId,c=e.chatDetails,u=e.toggleInfo,l=e.handleCall,d=e.show,f=matchMedia("(max-width: 768px)").matches;return(0,s.jsxs)("div",{className:(0,o.classNames)(i.default.chat_header,d&&i.default.show),children:[(0,s.jsxs)("div",{className:i.default.user_info,children:[(0,s.jsx)("div",{className:i.default.go_back,onClick:n,children:(0,s.jsx)("i",{className:"bx bx-chevron-left"})}),(0,s.jsx)(a.Avatar,{src:null===c||void 0===c?void 0:c.avatar,name:null===c||void 0===c?void 0:c.name,size:50,status:null===c||void 0===c?void 0:c.status,userId:null===c||void 0===c?void 0:c.userId}),(0,s.jsxs)("div",{className:i.default.user_name,children:[(0,s.jsx)("b",{children:null===c||void 0===c?void 0:c.name}),(0,s.jsx)("span",{userid:null===c||void 0===c?void 0:c.userId,children:null!==c&&void 0!==c&&c.users?"".concat(null===c||void 0===c||null===(t=c.users)||void 0===t?void 0:t.length," Members"):null!==c&&void 0!==c&&c.status?"Online":"Offline"})]})]}),(0,s.jsxs)("div",{className:i.default.chat_icons,children:[(0,s.jsx)("i",{className:"bx-video",onClick:function(){return l("video")}}),(0,s.jsx)("i",{className:"bxs-info-circle",onClick:u}),(0,s.jsx)("i",{className:"bx-dots-vertical-rounded",id:"more-option"}),(0,s.jsxs)(a.DropDown,{selector:"#more-option",placement:"bottom-end",zIndex:2001,children:[f&&(0,s.jsxs)(r.Fragment,{children:[(0,s.jsxs)(a.DropDownItem,{className:"dropdown-option",onClick:u,children:[(0,s.jsx)("span",{children:"View Profile"}),(0,s.jsx)("i",{className:"bx bx-user"})]}),(0,s.jsxs)(a.DropDownItem,{className:"dropdown-option",onClick:function(){return l("video")},children:[(0,s.jsx)("span",{children:"Video"}),(0,s.jsx)("i",{className:"bx bx-video"})]})]}),(0,s.jsxs)(a.DropDownItem,{className:"dropdown-option",children:[(0,s.jsx)("span",{children:"Muted"}),(0,s.jsx)("i",{className:"bx-microphone-off"})]}),(0,s.jsxs)(a.DropDownItem,{className:"dropdown-option",children:[(0,s.jsx)("span",{children:"Delete"}),(0,s.jsx)("i",{className:"bx-trash"})]})]})]})]})}},4273:function(e,t,n){n.r(t),n.d(t,{Loader:function(){return o}});n(2791);var r=n(67),a=n(184),o=function(){return(0,a.jsxs)("div",{className:r.default.loader,children:[(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{})]})}},3414:function(e,t,n){n.r(t),n.d(t,{PageLoader:function(){return i}});n(2791);var r=n(2703),a=n(22),o=n(184),i=function(){var e=["25%","27.5%","30%","32.5%","35%"],t=Array.from({length:10},(function(){return e[Math.floor(Math.random()*e.length)]}));return(0,o.jsx)("div",{className:a.default.container,children:t.map((function(e,t){return(0,o.jsxs)("div",{className:(0,r.classNames)(a.default.card,t%2===0&&a.default.end),style:{"--width":e},children:[(0,o.jsx)("div",{className:"".concat(a.default.line," skeleton")}),(0,o.jsx)("div",{className:"".concat(a.default.line," skeleton")})]},t)}))})}},8641:function(e,t,n){n.r(t),n.d(t,{Emoji:function(){return u}});var r=n(885),a=n(2791),o=n(9930),i=n(5357),s=n(517),c=n(184),u=function(e){var t=e.toggle,n=e.isOpen,u=e.selector,l=e.onChange,d=(0,a.useRef)(),f=function(e){return function(){l(e),t()}};return(0,c.jsx)(o.DropDown,{isOpen:n,toggle:t,selector:u,placement:"top-center",zIndex:2e3,children:(0,c.jsxs)("div",{className:s.default.emoji_container,children:[(0,c.jsxs)("div",{className:s.default.emoji_header,children:[[{label:"Smileys & People",icon:"bx-smile"},{label:"Animals & Nature",icon:"bx-leaf"},{label:"Travel & Places",icon:"bx-home-alt"},{label:"Activities",icon:"bx-baseball"},{label:"Objects",icon:"bx-world"},{label:"Symbols",icon:"bx-bulb"},{label:"Flags",icon:"bx-flag"}].map((function(e,t){var n,r=e.label,a=e.icon;return(0,c.jsxs)("div",{id:"emoji-type-".concat(t),className:s.default.emoji_type,onClick:(n=r,function(){var e=document.querySelector('[emoji-title="'.concat(n,'"]')).offsetTop;d.current.scrollTo(0,e-95)}),children:[(0,c.jsx)("i",{className:a}),(0,c.jsx)(o.Tooltip,{placement:"top",selector:"#emoji-type-".concat(t),offset:10,children:r})]},t)})),(0,c.jsxs)("div",{id:"emoji-close",className:s.default.close,onClick:t,children:[(0,c.jsx)("span",{children:"\u2a2f"}),(0,c.jsx)(o.Tooltip,{placement:"top",selector:"#emoji-close",offset:10,children:"Close"})]})]}),(0,c.jsxs)("div",{className:s.default.search_emoji,children:[(0,c.jsx)("input",{type:"text",placeholder:"Search Emoji"}),(0,c.jsx)("div",{className:s.default.search_icon,children:(0,c.jsx)("i",{className:"bx-search-alt-2"})})]}),(0,c.jsx)("div",{className:s.default.emoji_card,ref:d,children:Object.entries(i).map((function(e,t){var n=(0,r.Z)(e,2),a=n[0],o=n[1];return(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:s.default.emoji_title,"emoji-title":a,children:(0,c.jsx)("b",{children:a})}),(0,c.jsx)("div",{className:s.default.emoji_list,children:o.map((function(e,t){var n=e.emoji,r=e.description;return(0,c.jsx)("button",{title:r,onClick:f(n),children:(0,c.jsx)("div",{className:s.default.emoji_icon,children:n})},t)}))})]},t)}))})]})})}},1077:function(e,t,n){n.r(t),n.d(t,{TextArea:function(){return h}});var r=n(7762),a=n(4165),o=n(5861),i=n(885),s=n(2791),c=n(3487),u=n(8641),l=n(5145),d=n(2703),f=n(9102),p=n(8731),m=n(184),h=function(e){var t=e.onSend,n=e.onFocus,h=e.chatId,v=e.otherUser,_=(0,s.useState)(!1),x=(0,i.Z)(_,2),j=x[0],g=x[1],y=(0,s.useState)(""),b=(0,i.Z)(y,2),w=b[0],Z=b[1],k=(0,s.useState)(),C=(0,i.Z)(k,2),N=C[0],I=C[1],D=(0,s.useState)(!1),S=(0,i.Z)(D,2),E=S[0],T=S[1],M=(0,s.useRef)();(0,s.useEffect)((function(){var e=new(window.SpeechRecognition||window.webkitSpeechRecognition);e.interimResults=!0,e.continuous=!0,e.onstart=function(e){console.log(e)},e.onend=function(e){console.log(e)},e.onresult=function(e){var t=e.results,n=Array.from(t).map((function(e){return e[0]})).map((function(e){return e.transcript})).join("");Z(w.concat(n))},e.onerror=function(e){console.log(e)},I(e)}),[]);var O=function(){return Array.isArray(v)?v.map((function(e){return{id:e._id,name:e.name}})):v},A=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(n=M.current.value).length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t(n);case 5:M.current.value="";case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,s,u,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.files,e.prev=1,o=new FormData,i=(0,r.Z)(n);try{for(i.s();!(s=i.n()).done;)u=s.value,o.append("file",u)}catch(a){i.e(a)}finally{i.f()}return e.next=7,(0,c.fileUpload)(o);case 7:d=e.sent,console.log(d),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),(0,l.Toast)({type:"error",message:null===e.t0||void 0===e.t0?void 0:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsxs)(s.Fragment,{children:[(0,m.jsxs)("div",{className:p.default.chat_input,children:[(0,m.jsx)("i",{className:"bx-smile",id:"emoji"}),(0,m.jsxs)("div",{className:p.default.input_field,children:[(0,m.jsx)("textarea",{ref:M,placeholder:"Type your message...",name:"chat-input",onFocus:n,onKeyDown:function(){E||(f.socket.emit("start-typing",h,O()),T(!0))},onChange:(0,d.debounce)((function(){f.socket.emit("end-typing",h,O()),T(!1)}),1e3)}),(0,m.jsx)("label",{htmlFor:"chat-file",children:(0,m.jsx)("i",{className:"bx-paperclip",id:"attach"})}),(0,m.jsx)("input",{id:"chat-file",type:"file",onChange:P,multiple:!0,hidden:!0})]}),(0,m.jsx)("button",{onClick:A,children:(0,m.jsx)("i",{className:"bxs-send"})}),(0,m.jsx)("i",{className:"bx-microphone",id:"mic",onPointerDown:function(){null===N||void 0===N||N.start()},onPointerUp:function(){null===N||void 0===N||N.stop()}})]}),(0,m.jsx)(u.Emoji,{selector:"#emoji",isOpen:j,toggle:function(){g(!j)},onChange:function(e){Z(w.concat(e))}})]})}},8325:function(e,t,n){n.r(t),n.d(t,{VideoPopup:function(){return i}});n(2791);var r=n(9930),a=n(2786),o=n(184),i=function(e){var t=e.isOpen;return(0,o.jsx)(r.Modal,{isOpen:t,width:750,closeClickOnOutside:!1,zIndex:2002,children:(0,o.jsxs)("div",{className:a.default.video_container,children:[(0,o.jsx)("video",{id:"local-stream",className:a.default.local,poster:"https://vue.pixelstrap.com/chitchat/_nuxt/img/videocall.336a27d.jpg",autoPlay:!0,muted:!0}),(0,o.jsx)("video",{id:"remote-stream",className:a.default.remote,poster:"https://vue.pixelstrap.com/chitchat/_nuxt/img/videocall_bg.ab164fb.jpg",autoPlay:!0})]})})}},7352:function(e,t,n){n.r(t),n.d(t,{Chat:function(){return D}});var r=n(4942),a=n(2982),o=n(1413),i=n(4165),s=n(5861),c=n(885),u=n(2791),l=n(9930),d=n(1077),f=n(1256),p=n(2775),m=n(8325),h=n(4717),v=n(3537),_=n(9855),x=n(2449),j=n(2703),g=n(5322),y=n(9102),b=n(4273),w=n(3414),Z=n(101),k=n(4329),C=n(9961),N=n(184),I=new Audio(Z),D=function(){var e,t=(0,u.useRef)(),n=(0,u.useRef)(),Z=(0,h.useAuth)(),D=Z.user,S=Z.chatId,E=Z.clearChatId,T=(0,u.useRef)(),M=(0,u.useState)({}),O=(0,c.Z)(M,2),A=O[0],P=O[1],R=(0,u.useState)(!1),F=(0,c.Z)(R,2),L=F[0],q=F[1],H=(0,u.useState)(!1),U=(0,c.Z)(H,2),B=U[0],z=U[1],Q=(0,u.useState)(null),V=(0,c.Z)(Q,2),Y=V[0],K=V[1],G=(0,u.useState)({}),J=(0,c.Z)(G,2),W=J[0],X=J[1],$=(0,u.useState)({}),ee=(0,c.Z)($,2),te=ee[0],ne=ee[1],re=(0,u.useState)({id:null,count:null,list:[]}),ae=(0,c.Z)(re,2),oe=ae[0],ie=ae[1],se=(0,u.useState)(!1),ce=(0,c.Z)(se,2),ue=ce[0],le=ce[1],de=(0,u.useState)(),fe=(0,c.Z)(de,2),pe=fe[0],me=fe[1],he=(0,u.useRef)();(0,u.useEffect)((function(){return document.addEventListener("socket",ve),function(){document.removeEventListener("socket",ve)}}),[]),(0,u.useEffect)((function(){0!==Object.keys(A).length&&P({}),ge()}),[S]),(0,u.useEffect)((function(){if(oe.list.length>0){var e=oe.list.map((function(e){return e._id}));we({msgId:e})}he.current&&0!==Object.keys(A).length&&Ne(he.current)}),[A]),(0,u.useEffect)((function(){he.current&&!pe&&Ne(he.current)}),[pe]);var ve=function(){y.socket.on("message",De),y.socket.on("seen",Se),y.socket.on("receive-offer",Re),y.socket.on("receive-answer",Fe),y.socket.on("start-typing",_e),y.socket.on("end-typing",xe)},_e=function(e,n){var r=sessionStorage.getItem("chatId");if(r&&e===r&&t.current){var a=t.current.querySelector("[typingstatus]");a&&a.setAttribute("typing","".concat(n.split(" ")[0]," is typing..."))}},xe=function(e){var n=sessionStorage.getItem("chatId");if(n&&e===n&&t.current){var r=t.current.querySelector("[typingstatus]");r&&r.removeAttribute("typing")}},je=function(){q(!L)},ge=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(){var t,n,r,a,o,s,u,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return me(!0),t={page:1,limit:30},e.prev=2,e.next=5,Promise.all([(0,_.getChatById)(S),(0,v.getMessagesByChatId)(S,t)]);case 5:n=e.sent,r=(0,c.Z)(n,2),a=r[0].data.data,o=r[1].data.data,s=o.list,u=o.newMessages,d=o.pageMeta,ne(a),be(s,u,d),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),(0,l.Toast)({type:"error",message:null===e.t0||void 0===e.t0?void 0:e.t0.message});case 19:return e.prev=19,setTimeout((function(){return me(!1)}),100),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={limit:30,page:t},e.next=4,(0,v.getMessagesByChatId)(S,n);case 4:r=e.sent,a=r.data.data,o=a.list,s=a.newMessages,c=a.pageMeta,be(o,s,c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),(0,l.Toast)({type:"error",message:null===e.t0||void 0===e.t0?void 0:e.t0.message});case 15:return e.prev=15,le(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})));return function(t){return e.apply(this,arguments)}}(),be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;if(0!==e.length||0!==t.length){if(t.length>0){var i,s=null===(i=t[0])||void 0===i?void 0:i._id;he.current=s,e=e.concat(t),ie((0,o.Z)((0,o.Z)({},oe),{},{id:s,count:t.length,list:t}))}else{var u;he.current=null===(u=e[e.length-1])||void 0===u?void 0:u._id}var l=e.reduce((function(e,t){var n=Me(t.date);return e.hasOwnProperty(n)?(0,o.Z)((0,o.Z)({},e),{},(0,r.Z)({},n,[].concat((0,a.Z)(e[n]),[t]))):(0,o.Z)((0,o.Z)({},e),{},(0,r.Z)({},n,[t]))}),{});0!==Object.keys(l).length&&(P((function(e){var t=Object.entries(l).reduce((function(e,t){var n=(0,c.Z)(t,2),i=n[0],s=n[1],u=Me(i);return e.hasOwnProperty(u)?(0,o.Z)((0,o.Z)({},e),{},(0,r.Z)({},u,[].concat((0,a.Z)(e[u]),(0,a.Z)(s)).sort((function(e,t){return new Date(e.date)-new Date(t.date)})))):(0,o.Z)((0,o.Z)({},e),{},(0,r.Z)({},u,s))}),e);return Object.keys(t).sort((function(e,t){return new Date(e)-new Date(t)})).reduce((function(e,n){return(0,o.Z)((0,o.Z)({},e),{},(0,r.Z)({},n,t[n]))}),{})})),X(n))}},we=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,_.markAsRead)(S,t);case 5:ie((0,o.Z)((0,o.Z)({},oe),{},{list:[]})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),Ze=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=(0,o.Z)({msg:t,date:(new Date).toISOString()},Y&&{reply:Y}),e.next=4,(0,v.createMessage)(S,n);case 4:r=e.sent,a=r.data.data,ke(a),Y&&Ce(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),(0,l.Toast)({type:"error",message:null===e.t0||void 0===e.t0?void 0:e.t0.message});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),ke=function(e){var t=Me(e.date);he.current=e._id,P((function(n){return n.hasOwnProperty(t)?(0,o.Z)((0,o.Z)({},n),{},(0,r.Z)({},t,[].concat((0,a.Z)(n[t]),[e]))):(0,o.Z)((0,o.Z)({},n),{},(0,r.Z)({},t,[e]))}))},Ce=function(){K(null)},Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he.current||null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";if(e){var n=document.querySelector("[msgid='".concat(e,"']"));n&&n.scrollIntoView({block:"center",behavior:t})}},Ie=(0,u.useMemo)((function(){return null}),[Y]),De=function(e){e.sender!==(null===D||void 0===D?void 0:D.id)&&(Te(e.msg),Ee(),ke(e),we({msgId:e._id}))},Se=function(e){var t=e.userId,n=e.msgId;if((null===D||void 0===D?void 0:D.id)!==t){var r=function(e){var t=document.querySelector("[msgid='".concat(e,"']"));t&&t.querySelector("[seen]").setAttribute("seen",!0)};Array.isArray(n)?n.forEach((function(e){r(e)})):r(n)}},Ee=function(){I.muted=!1,I.play()},Te=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("granted"===Notification.permission){e.next=2;break}return e.abrupt("return");case 2:new Notification("New Message",{body:t,icon:k});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(e){return e.split("T")[0]},Oe=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(!0),e.prev=1,T.current=new RTCPeerConnection,T.current.onicecandidate=Pe,T.current.ontrack=Ae,e.next=7,navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!0});case 7:return n=e.sent,document.querySelector("#local-stream").srcObject=n,n.getTracks().forEach((function(e){T.current.addTrack(e,n)})),e.next=13,T.current.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1});case 13:return r=e.sent,e.next=16,T.current.setLocalDescription(r);case 16:return a={date:(new Date).toISOString(),offer:r,type:t},e.next=19,(0,x.initiateCall)(S,a);case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(1),(0,l.Toast)({type:"error",message:null===e.t0||void 0===e.t0?void 0:e.t0.message});case 24:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t){return e.apply(this,arguments)}}(),Ae=function(e){var t=(0,c.Z)(e.streams,1)[0];document.querySelector("#remote-stream").srcObject=t},Pe=function(t){var n=t.target.localDescription,r=t.candidate;if(r&&(e=r),!r||!e)if("offer"===n.type){var a={offer:n,iceCandidate:e};y.socket.emit("send-offer",a,S)}else if("answer"===n.type){var o={answer:n,iceCandidate:e};y.socket.emit("send-answer",o,S)}},Re=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r,a,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.iceCandidate,r=t.offer,z(!0),a=new RTCPeerConnection,T.current=a,T.current.onicecandidate=Pe,T.current.ontrack=Ae,e.prev=6,e.next=9,navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!0});case 9:return o=e.sent,document.querySelector("#local-stream").srcObject=o,o.getTracks().forEach((function(e){T.current.addTrack(e,o)})),e.next=15,T.current.setRemoteDescription(r);case 15:return e.next=17,T.current.addIceCandidate(n);case 17:return e.next=19,T.current.createAnswer();case 19:return s=e.sent,e.next=22,T.current.setLocalDescription(s);case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(6),console.log(e.t0);case 27:case"end":return e.stop()}}),e,null,[[6,24]])})));return function(t){return e.apply(this,arguments)}}(),Fe=function(){var e=(0,s.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.iceCandidate,r=t.answer,e.prev=1,e.next=4,T.current.setRemoteDescription(r);case 4:return e.next=6,T.current.addIceCandidate(n);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return(0,N.jsxs)("div",{ref:t,className:C.default.chat_wrapper,onScroll:(0,j.debounce)((function(e){var t=e.target.scrollTop;if(!pe){var n=W.page,r=W.totalPages;0!==t||n>=r||(le(!0),setTimeout((function(){return ye(n+1)}),500))}}),100),children:[(0,N.jsx)(f.Header,{clearChatId:E,chatDetails:te,handleCall:Oe,toggleInfo:je,show:!!S}),ue&&(0,N.jsx)(b.Loader,{}),(0,N.jsx)("div",{className:C.default.chat_section,children:pe?(0,N.jsx)(w.PageLoader,{}):(0,N.jsx)(p.Conversation,{chats:A,onDelete:function(e,t){var n=Me(e);if(A.hasOwnProperty(n)){var a=A[n].filter((function(e){var n=e._id;return t!==n}));P((0,o.Z)((0,o.Z)({},A),{},(0,r.Z)({},n,a)))}},onCopy:function(e){navigator.clipboard.writeText(e)},onReply:function(e,t){var n=Me(e);K({key:n,id:t})},userId:null===D||void 0===D?void 0:D.id,otherUserId:(null===te||void 0===te?void 0:te.userId)||(null===te||void 0===te?void 0:te.users),focusMsgById:Ne,newMsg:oe,chatId:S})}),(0,N.jsx)(d.TextArea,{onSend:Ze,onFocus:function(){matchMedia("(max-width: 768px)").matches&&Ne()},chatId:S,otherUser:null!==te&&void 0!==te&&te.userId?{id:null===te||void 0===te?void 0:te.userId,name:null===te||void 0===te?void 0:te.name}:null===te||void 0===te?void 0:te.users}),(0,N.jsx)(g.Z,{in:Boolean(Y),timeout:250,classNames:{enterActive:C.default.reply_enter,exitActive:C.default.reply_exit},unmountOnExit:!0,children:(0,N.jsx)("div",{className:C.default.reply_container,ref:n,children:(0,N.jsxs)("div",{className:C.default.reply_card,children:[(0,N.jsx)("span",{className:"truncate-4",children:null===Ie||void 0===Ie?void 0:Ie.msg}),(0,N.jsx)("i",{className:"bx-x ".concat(C.default.close),onClick:Ce})]})})}),(0,N.jsx)(l.OffCanvas,{isOpen:L,position:"right",className:C.default.profile_sidebar,toggle:je,zIndex:2001,children:(0,N.jsx)("div",{children:"Hello"})}),(0,N.jsx)(m.VideoPopup,{isOpen:B})]})}},2449:function(e,t,n){n.r(t),n.d(t,{getCallHistory:function(){return o},initiateCall:function(){return i}});var r=n(9599),a=n(77),o=function(){return(0,r.axios)({url:a.endpoints.call.history,method:"get"})},i=function(e,t){return(0,r.axios)({url:"".concat(a.endpoints.call.initiate,"/").concat(e),method:"post",data:t})}},9855:function(e,t,n){n.r(t),n.d(t,{addToFavourite:function(){return s},getChatById:function(){return i},getChatByType:function(){return o},markAsRead:function(){return u},removeFromFavourite:function(){return c}});var r=n(9599),a=n(77),o=function(e){return(0,r.axios)({url:"".concat(a.endpoints.chat.list,"/").concat(e),method:"get"})},i=function(e){return(0,r.axios)({url:"".concat(a.endpoints.chat.chatDetails,"/").concat(e),method:"get"})},s=function(e){return(0,r.axios)({url:a.endpoints.chat.addFavourite,method:"put"})},c=function(e){return(0,r.axios)({url:a.endpoints.chat.removeFavourite,method:"delete"})},u=function(e,t){return(0,r.axios)({url:"".concat(a.endpoints.chat.markAsRead,"/").concat(e),method:"put",data:t})}},3537:function(e,t,n){n.r(t),n.d(t,{createMessage:function(){return o},getMessagesByChatId:function(){return i}});var r=n(9599),a=n(77),o=function(e,t){return(0,r.axios)({url:"".concat(a.endpoints.message.createMessage,"/").concat(e),method:"post",data:t})},i=function(e,t){return(0,r.axios)({url:"".concat(a.endpoints.message.getMessages,"/").concat(e),method:"get",params:t})}},3487:function(e,t,n){n.r(t),n.d(t,{fileUpload:function(){return c},metaData:function(){return s}});var r=n(4165),a=n(5861),o=n(9599),i=n(77),s=(n(9930),function(e){var t;return(0,o.axios)({url:null===(t=i.endpoints.others)||void 0===t?void 0:t.metaData,method:"post",data:e})}),c=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.axios)({url:null===(n=i.endpoints.others)||void 0===n?void 0:n.fileUpload,method:"post",data:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},9599:function(e,t,n){n.r(t),n.d(t,{axios:function(){return s}});var r=n(4569),a=n.n(r),o=n(2703),i=n(77),s=a().create({baseURL:i.baseURL});s.interceptors.request.use((function(e){var t=(0,o.cookies)().get("authToken");return t&&(e.headers.Authorization=t),e}),(function(e){return Promise.reject(e)})),s.interceptors.response.use((function(e){return e}),(function(e){var t;return 401===e.response.status&&document.dispatchEvent(new CustomEvent("logout")),Promise.reject(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)}))},9961:function(e,t,n){n.r(t),t.default={chat_wrapper:"Chat_chat_wrapper__gid5u",chat_section:"Chat_chat_section__3JB1Y",chat_skeleton:"Chat_chat_skeleton__6w6um",reply_enter:"Chat_reply_enter__QdcSq","from-bottom":"Chat_from-bottom__yjlc1",reply_exit:"Chat_reply_exit__CEbB5",reply_container:"Chat_reply_container__Hj6fN",reply_card:"Chat_reply_card__6LYq6",close:"Chat_close__2-iqb",profile_sidebar:"Chat_profile_sidebar__DYbvp","zoom-in":"Chat_zoom-in__p3vEB"}},8527:function(e,t,n){n.r(t),t.default={container:"Conversation_container__I7CJi",chat_wrapper:"Conversation_chat_wrapper__S3O8R",end:"Conversation_end__ZMbi5",chat_card:"Conversation_chat_card__jz70L",reply_card:"Conversation_reply_card__AEy90",msg_time:"Conversation_msg_time__wN53F",tick:"Conversation_tick__RkyEe",clock:"Conversation_clock__y4n8i",options:"Conversation_options__WLSBI",date:"Conversation_date__ZfQTB",unread_msg:"Conversation_unread_msg__yFItk",typing:"Conversation_typing__Q3x0K",section:"Conversation_section__wG88I",load:"Conversation_load__rqCbg"}},9041:function(e,t,n){n.r(t),t.default={chat_header:"Header_chat_header__QpmQQ",user_info:"Header_user_info__iEHZa",go_back:"Header_go_back__lCP4K",user_name:"Header_user_name__Trw38",chat_icons:"Header_chat_icons__JOz6D",show:"Header_show__F368n"}},67:function(e,t,n){n.r(t),t.default={loader:"Loader_loader__gQpe+",rotation:"Loader_rotation__Q-TX-"}},22:function(e,t,n){n.r(t),t.default={container:"PageLoader_container__WEvcy",card:"PageLoader_card__Fmr-Q",end:"PageLoader_end__ahXWd",line:"PageLoader_line__y70Cl"}},517:function(e,t,n){n.r(t),t.default={emoji_enter:"Emoji_emoji_enter__hm4pK",emoji_container:"Emoji_emoji_container__FeFYJ",emoji_wrapper:"Emoji_emoji_wrapper__Mni-7","emoji-anime":"Emoji_emoji-anime__vboWK",emoji_exit:"Emoji_emoji_exit__yUFuv",emoji_header:"Emoji_emoji_header__HJTsc",emoji_type:"Emoji_emoji_type__Hmz-D",close:"Emoji_close__Tlf+A",search_emoji:"Emoji_search_emoji__QHZYs",search_icon:"Emoji_search_icon__EVS9p",emoji_card:"Emoji_emoji_card__cVAbK",emoji_title:"Emoji_emoji_title__uaqYB",emoji_list:"Emoji_emoji_list__zUunG",emoji_icon:"Emoji_emoji_icon__QGww2"}},8731:function(e,t,n){n.r(t),t.default={chat_input:"TextArea_chat_input__+dl6x",input_field:"TextArea_input_field__++nq-"}},2786:function(e,t,n){n.r(t),t.default={video_container:"VideoPopup_video_container__EcnPE",remote:"VideoPopup_remote__x1HvW",local:"VideoPopup_local__xIYkj"}},101:function(e,t,n){e.exports=n.p+"static/media/fade-in-tone.4355e6fe3e157d8945f6.mp3"},4329:function(e,t,n){e.exports=n.p+"static/media/favicon.6072f0ecd8b7685691ff.ico"}}]);
//# sourceMappingURL=7352.7f751e6b.chunk.js.map